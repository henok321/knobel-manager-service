#!/bin/sh

# Your pre-commit hook to lint staged Go files
STAGED_GO_FILES=$(git diff --cached --name-only --diff-filter=d | grep '\.go$')

if [ -z "$STAGED_GO_FILES" ]; then
  echo "No Go files staged for commit."
  exit 0
fi

echo "Running golangci-lint on staged files..."
echo "$STAGED_GO_FILES" | xargs golangci-lint run --verbose --new-from-rev=HEAD

if [ $? -ne 0 ]; then
  echo "Linting failed! Fix the errors before committing."
  exit 1
fi

echo "All staged Go files passed linting."
exit 0
